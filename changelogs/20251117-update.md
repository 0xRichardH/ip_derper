# Tailscale Update

**Date**: 2025-11-17
**Tailscale Version**: v1.91.0-pre
**Previous Commit**: ae3dff15e40982d3aeaf0e457001da434cb4e6d8
**New Commit**: 3a41c0c585f4b008c07a02ae91ed43cdbb62c721

## Changes
- ipn/ipnlocal: add PROXY protocol support to Funnel/Serve (3a41c0c58)
- types/netmap: remove PrivateKey from NetworkMap (653d0738f)
- util/cache: remove unused code (98aadbaf5)
- wgengine/netlog: fix send to closed channel in test (4e01e8a66)
- util/clientmetric: fix regression causing Metric.v to be uninitialised (8aa46a395)
- cmd/tailscale/cli: fix panic in netcheck with mismatched DERP region IDs Fixes #17564 (8444659ed)
- net/udprelay: implement Server.SetStaticAddrPorts (#17909) (e1f0ad7a0)
- control/controlclient,ipn/ipnlocal: replace State enum with boolean flags (a96ef432c)
- feature/tpm: check IsZero in clone instead of just nil (#17884) (c5919b4ed)
- ipn/localapi: use constant-time comparison for RequiredPassword (#17906) (888a5d481)
- various: adds missing apostrophes to comments (913444000)
- scripts/installer.sh: compare major versions numerically (#17904) (bd36817e8)
- net/netmon: do not abandon a subscriber when exiting early (#17899) (ab4b990d5)
- wgengine/wgcfg/nmcfg: reduce wireguard reconfig log spam (ce10f7c14)
- logpolicy: fix nil pointer dereference with invalid TS_LOG_TARGET (208a32af5)
- control/controlclient: make Observer optional (052602752)
- feature/relayserver: fix Shutdown() deadlock (#17898) (0285e1d5f)
- ipn/ipnlocal: log prefs changes and reason in Start (#17876) (124301fbb)
- tka: add a test for unmarshaling existing AUMs (b5cd29932)
- feature/relayserver,ipn/ipnlocal,net/udprelay: plumb DERPMap (#17881) (9e4d1fd87)
- ipn/ipnlocal: remove all the weird locking (LockedOnEntry, UnlockEarly, etc) (146ea4282)
- cmd/cloner: support cloning arbitrarily-nested maps (08e74effc)
- cmd/tailscale/cli: remove service flag from funnel command (#17850) (ca9b68aaf)
- cmd/{cloner,viewer}: handle maps of views (6ac80b733)
- net/udprelay: replace VNI pool with selection algorithm (#17868) (f4f9dd7f8)
- licenses: update license notices (31fe75ad9)
- util/dnsname: fix test error message (37aa7e693)
- wgengine/wgcfg: remove two unused Config fields (f387b1010)
- util/dnsname: increase maxNameLength to account for trailing dot (27a0168cd)
- ipn/ipnlocal, net/netns: add node cap to disable netns interface binding on netext Apple clients (#17691) (e8d2f9644)
- net/batching: fix gro size handling for misordered UDP_GRO messages (#17842) (16e90dcb2)
- cmd/k8s-operator: remove early return in ingress matching (#17841) (d37884c73)
- wf: correct IPv6 link-local range from ff80::/10 to fe80::/10 (#17840) (85cb64c4f)
- wgengine/router/osrouter: fix linux magicsock port changing (3280dac79)
- util/eventbus: log goroutine stacks when hung in CI (1eba5b0cb)
- wgengine/magicsock: unblock Conn.Synchronize on Conn.Close (42ce5c88b)
- wgengine/magicsock: fix UDPRelayAllocReq/Resp deadlock (#17831) (2ad2d4d40)
- wgengine/magicsock: validate endpoint.derpAddr in Conn.onUDPRelayAllocResp (#17828) (18806de40)
- ipn/ipnlocal: fix state_test data race seen in CI (465006132)
- tsnet: add tstest.Shard on the slow tests (6e24f5094)
- ipn/ipnlocal: move vipServiceHash etc to serve.go, out of local.go (8ed6bb319)
- feature, ipn/ipnlocal: add, use feature.CanSystemdStatus for more DCE (e0e873113)
- wgengine/magicsock: clean up determineEndpoints docs (#17822) (e05938217)
- wgengine: make getStatus a bit cheaper (less alloc-y) (fe5501a4e)
- tka: log a better error if there are no chain candidates (4c67df42f)
- tka: remove an unused parameter from `computeActiveAncestor` (c7dbd3987)
